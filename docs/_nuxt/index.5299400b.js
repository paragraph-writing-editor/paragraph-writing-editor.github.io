var mt=Object.defineProperty;var gt=(n,t,e)=>t in n?mt(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var I=(n,t,e)=>(gt(n,typeof t!="symbol"?t+"":t,e),e);import{a as V,r as y,t as Q,w as G,b as vt,o as l,e as c,f as q,v as Ct,h as r,u,i as $t,j as g,k as L,l as x,m,p as $,q as H,s as h,x as v,y as X,z as J,A as S,B as E,c as Y,F,C as T,D as tt,E as bt,G as wt,H as kt,S as j}from"./entry.a14eb115.js";import{_ as yt,a as St,u as Ht}from"./useSentenceBoundaryDetectionSettings.fea17cd2.js";const It={class:"lite-textarea"},Vt=V({__name:"WriteDownAreaLite",props:{modelValue:null},emits:["update:modelValue"],setup(n,{emit:t}){const e=n,s=y(e.modelValue),a=y(null),{modelValue:o}=Q(e);G(o,(d,C)=>{const p=()=>d!=C,b=()=>s.value!=d;p()&&b()&&(s.value=d,vt(()=>a.value.focus()))});const i=$t(()=>{t("update:modelValue",s.value)});return(d,C)=>(l(),c("div",It,[q(r("textarea",{placeholder:"Write down here.",ref_key:"areaRef",ref:a,"onUpdate:modelValue":C[0]||(C[0]=p=>s.value=p),onInput:C[1]||(C[1]=(...p)=>u(i)&&u(i)(...p))},null,544),[[Ct,s.value]])]))}}),Lt=g(Vt,[["__scopeId","data-v-22f942a0"]]),At={},Mt={class:"icon-partition"};function Bt(n,t){return l(),c("button",Mt,[L(n.$slots,"default",{},()=>[x("|")],!0)])}const Pt=g(At,[["render",Bt],["__scopeId","data-v-4037046d"]]),Rt={name:"ClipboardFileOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},zt=["aria-hidden","aria-label"],Nt=["fill","width","height"],Ot={d:"M15 23C13.9 23 13 22.11 13 21V12C13 10.9 13.9 10 15 10H19L23 14V21C23 22.11 22.11 23 21 23H15M15 21H21V14.83L18.17 12H15V21M19 3C20.1 3 21 3.9 21 5V9.17L19.83 8H19V5H17V7H7V5H5V19H11V21H5C3.9 21 3 20.1 3 19V5C3 3.9 3.9 3 5 3H9.18C9.6 1.84 10.7 1 12 1C13.3 1 14.4 1.84 14.82 3H19M12 3C11.45 3 11 3.45 11 4C11 4.55 11.45 5 12 5C12.55 5 13 4.55 13 4C13 3.45 12.55 3 12 3Z"},xt={key:0};function Ft(n,t,e,s,a,o){return l(),c("span",H(n.$attrs,{"aria-hidden":!e.title,"aria-label":e.title,class:"material-design-icon clipboard-file-outline-icon",role:"img",onClick:t[0]||(t[0]=i=>n.$emit("click",i))}),[(l(),c("svg",{fill:e.fillColor,class:"material-design-icon__svg",width:e.size,height:e.size,viewBox:"0 0 24 24"},[r("path",Ot,[e.title?(l(),c("title",xt,m(e.title),1)):$("",!0)])],8,Nt))],16,zt)}const Dt=g(Rt,[["render",Ft]]),Et={name:"ClipboardEditOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},Tt=["aria-hidden","aria-label"],Ut=["fill","width","height"],Gt={d:"M21.04 12.13C21.18 12.13 21.31 12.19 21.42 12.3L22.7 13.58C22.92 13.79 22.92 14.14 22.7 14.35L21.7 15.35L19.65 13.3L20.65 12.3C20.76 12.19 20.9 12.13 21.04 12.13M19.07 13.88L21.12 15.93L15.06 22H13V19.94L19.07 13.88M11 19L9 21H5C3.9 21 3 20.1 3 19V5C3 3.9 3.9 3 5 3H9.18C9.6 1.84 10.7 1 12 1C13.3 1 14.4 1.84 14.82 3H19C20.1 3 21 3.9 21 5V9L19 11V5H17V7H7V5H5V19H11M12 3C11.45 3 11 3.45 11 4C11 4.55 11.45 5 12 5C12.55 5 13 4.55 13 4C13 3.45 12.55 3 12 3Z"},Zt={key:0};function Kt(n,t,e,s,a,o){return l(),c("span",H(n.$attrs,{"aria-hidden":!e.title,"aria-label":e.title,class:"material-design-icon clipboard-edit-outline-icon",role:"img",onClick:t[0]||(t[0]=i=>n.$emit("click",i))}),[(l(),c("svg",{fill:e.fillColor,class:"material-design-icon__svg",width:e.size,height:e.size,viewBox:"0 0 24 24"},[r("path",Gt,[e.title?(l(),c("title",Zt,m(e.title),1)):$("",!0)])],8,Ut))],16,Tt)}const jt=g(Et,[["render",Kt]]),Wt={name:"DotsHorizontalIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},Qt=["aria-hidden","aria-label"],qt=["fill","width","height"],Xt={d:"M16,12A2,2 0 0,1 18,10A2,2 0 0,1 20,12A2,2 0 0,1 18,14A2,2 0 0,1 16,12M10,12A2,2 0 0,1 12,10A2,2 0 0,1 14,12A2,2 0 0,1 12,14A2,2 0 0,1 10,12M4,12A2,2 0 0,1 6,10A2,2 0 0,1 8,12A2,2 0 0,1 6,14A2,2 0 0,1 4,12Z"},Jt={key:0};function Yt(n,t,e,s,a,o){return l(),c("span",H(n.$attrs,{"aria-hidden":!e.title,"aria-label":e.title,class:"material-design-icon dots-horizontal-icon",role:"img",onClick:t[0]||(t[0]=i=>n.$emit("click",i))}),[(l(),c("svg",{fill:e.fillColor,class:"material-design-icon__svg",width:e.size,height:e.size,viewBox:"0 0 24 24"},[r("path",Xt,[e.title?(l(),c("title",Jt,m(e.title),1)):$("",!0)])],8,qt))],16,Qt)}const te=g(Wt,[["render",Yt]]),ee={name:"FileOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},ne=["aria-hidden","aria-label"],oe=["fill","width","height"],ae={d:"M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"},se={key:0};function ie(n,t,e,s,a,o){return l(),c("span",H(n.$attrs,{"aria-hidden":!e.title,"aria-label":e.title,class:"material-design-icon file-outline-icon",role:"img",onClick:t[0]||(t[0]=i=>n.$emit("click",i))}),[(l(),c("svg",{fill:e.fillColor,class:"material-design-icon__svg",width:e.size,height:e.size,viewBox:"0 0 24 24"},[r("path",ae,[e.title?(l(),c("title",se,m(e.title),1)):$("",!0)])],8,oe))],16,ne)}const le=g(ee,[["render",ie]]),ce={name:"FolderOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},re=["aria-hidden","aria-label"],de=["fill","width","height"],ue={d:"M20,18H4V8H20M20,6H12L10,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8C22,6.89 21.1,6 20,6Z"},_e={key:0};function he(n,t,e,s,a,o){return l(),c("span",H(n.$attrs,{"aria-hidden":!e.title,"aria-label":e.title,class:"material-design-icon folder-outline-icon",role:"img",onClick:t[0]||(t[0]=i=>n.$emit("click",i))}),[(l(),c("svg",{fill:e.fillColor,class:"material-design-icon__svg",width:e.size,height:e.size,viewBox:"0 0 24 24"},[r("path",ue,[e.title?(l(),c("title",_e,m(e.title),1)):$("",!0)])],8,de))],16,re)}const pe=g(ce,[["render",he]]),fe={name:"RedoIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},me=["aria-hidden","aria-label"],ge=["fill","width","height"],ve={d:"M18.4,10.6C16.55,9 14.15,8 11.5,8C6.85,8 2.92,11.03 1.54,15.22L3.9,16C4.95,12.81 7.95,10.5 11.5,10.5C13.45,10.5 15.23,11.22 16.62,12.38L13,16H22V7L18.4,10.6Z"},Ce={key:0};function $e(n,t,e,s,a,o){return l(),c("span",H(n.$attrs,{"aria-hidden":!e.title,"aria-label":e.title,class:"material-design-icon redo-icon",role:"img",onClick:t[0]||(t[0]=i=>n.$emit("click",i))}),[(l(),c("svg",{fill:e.fillColor,class:"material-design-icon__svg",width:e.size,height:e.size,viewBox:"0 0 24 24"},[r("path",ve,[e.title?(l(),c("title",Ce,m(e.title),1)):$("",!0)])],8,ge))],16,me)}const be=g(fe,[["render",$e]]),we={name:"ContentSaveOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},ke=["aria-hidden","aria-label"],ye=["fill","width","height"],Se={d:"M17 3H5C3.89 3 3 3.9 3 5V19C3 20.1 3.89 21 5 21H19C20.1 21 21 20.1 21 19V7L17 3M19 19H5V5H16.17L19 7.83V19M12 12C10.34 12 9 13.34 9 15S10.34 18 12 18 15 16.66 15 15 13.66 12 12 12M6 6H15V10H6V6Z"},He={key:0};function Ie(n,t,e,s,a,o){return l(),c("span",H(n.$attrs,{"aria-hidden":!e.title,"aria-label":e.title,class:"material-design-icon content-save-outline-icon",role:"img",onClick:t[0]||(t[0]=i=>n.$emit("click",i))}),[(l(),c("svg",{fill:e.fillColor,class:"material-design-icon__svg",width:e.size,height:e.size,viewBox:"0 0 24 24"},[r("path",Se,[e.title?(l(),c("title",He,m(e.title),1)):$("",!0)])],8,ye))],16,ke)}const Ve=g(we,[["render",Ie]]),Le={name:"UndoIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},Ae=["aria-hidden","aria-label"],Me=["fill","width","height"],Be={d:"M12.5,8C9.85,8 7.45,9 5.6,10.6L2,7V16H11L7.38,12.38C8.77,11.22 10.54,10.5 12.5,10.5C16.04,10.5 19.05,12.81 20.1,16L22.47,15.22C21.08,11.03 17.15,8 12.5,8Z"},Pe={key:0};function Re(n,t,e,s,a,o){return l(),c("span",H(n.$attrs,{"aria-hidden":!e.title,"aria-label":e.title,class:"material-design-icon undo-icon",role:"img",onClick:t[0]||(t[0]=i=>n.$emit("click",i))}),[(l(),c("svg",{fill:e.fillColor,class:"material-design-icon__svg",width:e.size,height:e.size,viewBox:"0 0 24 24"},[r("path",Be,[e.title?(l(),c("title",Pe,m(e.title),1)):$("",!0)])],8,Me))],16,Ae)}const ze=g(Le,[["render",Re]]),Ne=n=>(X("data-v-b4bfb75e"),n=n(),J(),n),Oe={class:"toolbar-window"},xe={class:"toolbar"},Fe={class:"etc-menus"},De={key:0,class:"boundary"},Ee=Ne(()=>r("div",{class:"title"},"Text formatting",-1)),Te={class:"workspace"},Ue=V({__name:"ToolBar",props:{textEmpty:{type:Boolean},canUndo:{type:Boolean},canRedo:{type:Boolean}},setup(n){const t=y(!1),e=s=>{t.value=!t.value,s&&typeof s=="function"&&s()};return(s,a)=>{const o=Pt,i=yt;return l(),c("div",Oe,[r("div",xe,[h(o),h(i,{"aria-label":"new text","data-balloon-pos":"down",onClick:a[0]||(a[0]=d=>s.$emit("new-click"))},{default:v(()=>[h(le)]),_:1}),h(o),h(i,{"aria-label":"text in clipboard","data-balloon-pos":"down",onClick:a[1]||(a[1]=d=>s.$emit("clipboard-click"))},{default:v(()=>[h(Dt)]),_:1}),h(i,{"aria-label":"copy to clipboard","data-balloon-pos":"down",disabled:n.textEmpty,onClick:a[2]||(a[2]=d=>s.$emit("copy-click"))},{default:v(()=>[h(jt)]),_:1},8,["disabled"]),h(o),h(i,{"aria-label":"texts in local storage","data-balloon-pos":"down",onClick:a[3]||(a[3]=d=>s.$emit("folder-click"))},{default:v(()=>[h(pe)]),_:1}),h(i,{"aria-label":"save to local storage","data-balloon-pos":"down",disabled:n.textEmpty,onClick:a[4]||(a[4]=d=>s.$emit("save-click"))},{default:v(()=>[h(Ve)]),_:1},8,["disabled"]),h(o),h(i,{"aria-label":"undo","data-balloon-pos":"down",disabled:!n.canUndo,onClick:a[5]||(a[5]=d=>s.$emit("undo-click"))},{default:v(()=>[h(ze)]),_:1},8,["disabled"]),h(i,{"aria-label":"redo","data-balloon-pos":"down",disabled:!n.canRedo,onClick:a[6]||(a[6]=d=>s.$emit("redo-click"))},{default:v(()=>[h(be)]),_:1},8,["disabled"]),h(o),r("div",Fe,[h(i,{onClick:e},{default:v(()=>[h(te)]),_:1}),t.value?(l(),c("div",De,[r("section",null,[Ee,r("div",{class:"item",onClick:a[7]||(a[7]=d=>e(()=>s.$emit("format-ospl-click")))},"One sentence per line"),r("div",{class:"item",onClick:a[8]||(a[8]=d=>e(()=>s.$emit("format-oppl-click")))},"One paragraph per line")])])):$("",!0)])]),r("div",Te,[L(s.$slots,"default",{},void 0,!0)])])}}}),Ge=g(Ue,[["__scopeId","data-v-b4bfb75e"]]),Ze=["disabled"],Ke=V({__name:"RoundedButton",props:{disabled:{type:Boolean,default:!1},destroy:{type:Boolean,default:!1}},setup(n){const t=n,e=S(()=>{const s=["rounded-button"];return t.destroy&&s.push("rounded-button--destroy"),s});return(s,a)=>(l(),c("button",{class:E(u(e).join(" ")),disabled:t.disabled},[L(s.$slots,"default",{},void 0,!0)],10,Ze))}}),je=g(Ke,[["__scopeId","data-v-ea301603"]]),Z="doc.snapshot",K="#";function We(){const n=et();return n.length===0?null:n[0]}function et(){return Object.keys(localStorage).filter(n=>n.startsWith(Z)).sort((n,t)=>t.localeCompare(n))}function U(n){return ot(n)?localStorage.getItem(n):null}function Qe(n){const t=new Date().getTime();localStorage.setItem(Z+K+t,n)}function nt(n){n.forEach(t=>{ot(t)&&localStorage.removeItem(t)})}function qe(n){const t=Number(n.split(K)[1]),e=new Date;return e.setTime(t),e}function ot(n){return n.startsWith(Z+K)}function Xe(){const n=y([]),t=y([]),e=S(()=>t.value.length==n.value.length),s=S(()=>{const p={};return n.value.forEach(b=>p[b]=U(b)),p}),a=p=>qe(p).toLocaleString().replace(/([^\d])([\d])([^\d])/g,"$10$2$3"),o=p=>s.value[p],i=()=>{n.value=et(),t.value=[]};return{docs:n,selectedDocs:t,selectedAll:e,getDateTime:a,getText:o,initialize:i,selectAll:()=>{e.value?t.value=[]:t.value=n.value},remove:()=>{nt(t.value),i()}}}const at=n=>(X("data-v-14a0e2a9"),n=n(),J(),n),Je=at(()=>r("h2",null,"Local Storage",-1)),Ye={key:0},tn=at(()=>r("p",null,"no texts exist",-1)),en=[tn],nn={key:1},on=["checked"],an={class:"operation"},sn=["data-key"],ln=["value"],cn={class:"text"},rn=V({__name:"FolderDialog",props:{dialog:{type:Boolean}},emits:["update:dialog","load"],setup(n,{emit:t}){const e=n,{docs:s,selectedDocs:a,selectedAll:o,getDateTime:i,getText:d,initialize:C,selectAll:p,remove:b}=Xe(),{dialog:D}=Q(e);G(D,(A,w)=>{A&&!w&&C()});const N=A=>{const w=A.target.dataset.key;t("load",w),t("update:dialog",!1)};return(A,w)=>{const O=je,B=St;return l(),Y(B,{dialog:e.dialog,"onUpdate:dialog":w[2]||(w[2]=k=>t("update:dialog",k))},{default:v(()=>[r("section",null,[Je,u(s).length?$("",!0):(l(),c("div",Ye,en)),u(s).length?(l(),c("div",nn,[r("p",null,[h(O,{destroy:"",disabled:!u(a).length,onClick:u(b)},{default:v(()=>[x("Remove selected items")]),_:1},8,["disabled","onClick"])]),r("p",null,[r("a",{onClick:w[0]||(w[0]=(...k)=>u(p)&&u(p)(...k))},[r("input",{type:"checkbox",checked:u(o)},null,8,on),x(" Select all ")])]),r("div",null,[(l(!0),c(F,null,T(u(s),k=>(l(),c("div",{class:"item",key:k},[r("div",an,[r("a",{onClick:N,"data-key":k},"Load from this",8,sn)]),r("p",null,[r("label",null,[q(r("input",{type:"checkbox",value:k,"onUpdate:modelValue":w[1]||(w[1]=P=>tt(a)?a.value=P:null)},null,8,ln),[[bt,u(a)]]),x(" "+m(u(i)(k)),1)])]),r("p",cn,m(u(d)(k)),1)]))),128))])])):$("",!0)])]),_:1},8,["dialog"])}}}),dn=g(rn,[["__scopeId","data-v-14a0e2a9"]]);class W{constructor(t,e){I(this,"type");I(this,"contents");this.type=t,this.contents=e?[e]:[]}append(t){this.contents.push(t)}isParagraph(){return this.type==_.P}countSentences(){return this.contents.length}countCharacters(){return this.contents.reduce((t,e)=>t+e.length,0)}}var _=(n=>(n.BR="br",n.H1="h1",n.H2="h2",n.H3="h3",n.H4="h4",n.H5="h5",n.H6="h6",n.HR="hr",n.P="p",n))(_||{});const un={key:0},_n={key:1},hn={key:2},pn={key:3},fn={key:4},mn={key:5},gn={key:6},vn={key:7},Cn=V({__name:"ReviewArea",props:{structure:null,style:null},setup(n){const t=e=>["sentence",e[e.length-1].match(/[ -~]/)?"sentence--half-width":"sentence--full-width"];return(e,s)=>(l(),c("div",{class:E(["review-window",n.style].join(" "))},[(l(!0),c(F,null,T(n.structure,a=>(l(),c(F,null,[a.type==u(_).P?(l(),c("p",un,[(l(!0),c(F,null,T(a.contents,o=>(l(),c("span",{class:E(t(o).join(" "))},m(o),3))),256))])):a.type==u(_).H1?(l(),c("h1",_n,m(a.contents[0]),1)):a.type==u(_).H2?(l(),c("h2",hn,m(a.contents[0]),1)):a.type==u(_).H3?(l(),c("h3",pn,m(a.contents[0]),1)):a.type==u(_).H4?(l(),c("h4",fn,m(a.contents[0]),1)):a.type==u(_).H5?(l(),c("h5",mn,m(a.contents[0]),1)):a.type==u(_).H6?(l(),c("h6",gn,m(a.contents[0]),1)):a.type==u(_).HR?(l(),c("hr",vn)):$("",!0)],64))),256))],2))}}),$n=g(Cn,[["__scopeId","data-v-84adcc9a"]]),bn={class:"status-indicator-window"},wn={class:"status-indicator"},kn={class:"characters"},yn={class:"sentences"},Sn={class:"paragraphs"},Hn={class:"view-space"},In=V({__name:"StatusIndicator",props:{structure:null},setup(n){const t=n,e=S(()=>{const s=t.structure.filter(i=>i.isParagraph()).length,a=t.structure.filter(i=>i.isParagraph()).map(i=>i.countSentences()).reduce((i,d)=>i+d,0),o=t.structure.filter(i=>i.isParagraph()).map(i=>i.countCharacters()).reduce((i,d)=>i+d,0);return{paragraphs:Math.min(s,a),sentences:a,characters:o}});return(s,a)=>(l(),c("div",bn,[r("div",wn,[r("span",kn,m(u(e).characters.toLocaleString())+" characters",1),r("span",yn,m(u(e).sentences.toLocaleString())+" sentences",1),r("span",Sn,m(u(e).paragraphs.toLocaleString())+" paragraphs",1)]),r("div",Hn,[L(s.$slots,"default",{},void 0,!0)])]))}}),Vn=g(In,[["__scopeId","data-v-02e0168f"]]),Ln={name:"SwapHorizontalIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},An=["aria-hidden","aria-label"],Mn=["fill","width","height"],Bn={d:"M21,9L17,5V8H10V10H17V13M7,11L3,15L7,19V16H14V14H7V11Z"},Pn={key:0};function Rn(n,t,e,s,a,o){return l(),c("span",H(n.$attrs,{"aria-hidden":!e.title,"aria-label":e.title,class:"material-design-icon swap-horizontal-icon",role:"img",onClick:t[0]||(t[0]=i=>n.$emit("click",i))}),[(l(),c("svg",{fill:e.fillColor,class:"material-design-icon__svg",width:e.size,height:e.size,viewBox:"0 0 24 24"},[r("path",Bn,[e.title?(l(),c("title",Pn,m(e.title),1)):$("",!0)])],8,Mn))],16,An)}const zn=g(Ln,[["render",Rn]]),Nn={class:"view-menu-window"},On={class:"view-menu"},xn={class:"label"},Fn={class:"view-space"},Dn=V({__name:"ViewMenu",props:{menu:null},emits:["update:menu"],setup(n,{emit:t}){const e=n,s=["topic-sentence-highlights","bulleted-topic-sentences"];wt(()=>{if(e.menu)return;const i=s[0];t("update:menu",i)});const a=S(()=>e.menu.replace(/-/g," ")),o=()=>{const i=s.indexOf(e.menu)+1;t("update:menu",s[i%s.length])};return(i,d)=>(l(),c("div",Nn,[r("div",On,[r("div",{class:"imitation-button",onClick:o},[h(zn),r("span",xn,m(u(a)),1)])]),r("div",Fn,[L(i.$slots,"default",{},void 0,!0)])]))}}),En=g(Dn,[["__scopeId","data-v-c3bba6cc"]]),Tn={},Un={class:"pages"},Gn={class:"left-page"},Zn={class:"right-page"};function Kn(n,t){return l(),c("div",Un,[r("div",Gn,[L(n.$slots,"left-page",{},void 0,!0)]),r("div",Zn,[L(n.$slots,"right-page",{},void 0,!0)])])}const jn=g(Tn,[["render",Kn],["__scopeId","data-v-dc3b3f64"]]);function Wn(){const n=y(""),t=S(()=>!n.value.trim().length);return{text:n,textEmpty:t,clearText:()=>{n.value=""}}}function Qn(n){return{loadFromClipboard:async()=>{const s=await navigator.clipboard.readText();s.trim().length>0&&(n.value=s.replace(/\r\n/g,`
`).trim())},saveToClipboard:async()=>{await navigator.clipboard.writeText(n.value)}}}function qn(n){return{loadFromLocalStorage:s=>{n.value=U(s)},saveToLocalStorage:()=>{var a;const s=We();s!=null&&((a=U(s))==null?void 0:a.trim())===n.value.trim()&&nt([s]),Qe(n.value)}}}function Xn(n){const t=y([n.value]),e=y([]);G(n,(d,C)=>{const p=()=>d.trim()!=C.trim(),b=()=>t.value[t.value.length-1]==d;p()&&!b()&&(t.value.length>12&&t.value.shift(),t.value.push(d),e.value.splice(0))});const s=S(()=>t.value.length>1),a=()=>{if(!s.value)return;const d=t.value.pop();e.value.push(d),n.value=t.value[t.value.length-1]},o=S(()=>e.value.length>0);return{canUndo:s,canRedo:o,undo:a,redo:()=>{if(!o.value)return;const d=e.value.pop();t.value.push(d),n.value=t.value[t.value.length-1]}}}class f{constructor(t,e){I(this,"type");I(this,"text");this.type=t,this.text=e}static detect(t){return f.detectHeadline(t)||f.detectHorizon(t)||f.detectLineBreak(t)||new f(_.P,t)}isLineBreak(){return this.type==_.BR}isSingleLineComposition(){switch(this.type){case _.H1:case _.H2:case _.H3:case _.H4:case _.H5:case _.H6:case _.HR:return!0;default:return!1}}isParagraphingComposition(){return!this.isLineBreak()&&!this.isSingleLineComposition()}static detectHeadline(t){return t.match(/^#{1} /)?new f(_.H1,t.substring(2)):t.match(/^#{2} /)?new f(_.H2,t.substring(3)):t.match(/^#{3} /)?new f(_.H3,t.substring(4)):t.match(/^#{4} /)?new f(_.H4,t.substring(5)):t.match(/^#{5} /)?new f(_.H5,t.substring(6)):t.match(/^#{6} /)?new f(_.H6,t.substring(7)):null}static detectHorizon(t){return t.match(/^\*\*\*/)?new f(_.HR):t.match(/^---/)?new f(_.HR):t.match(/^___/)?new f(_.HR):t.match(/^\* \* \*/)?new f(_.HR):t.match(/^- - -/)?new f(_.HR):t.match(/^_ _ _/)?new f(_.HR):null}static detectLineBreak(t){return t.trim().length===0?new f(_.BR):null}}function Jn(n,t){return{oneSentencePerLine:()=>{const a=[t.value.halfwidthDotSpace?o=>o.replace(/(\.) ([^\n])/g,`$1
$2`):o=>o,t.value.halfwidthDotDoubleQuotationSpace?o=>o.replace(/(\.\") ([^\n])/g,`$1
$2`):o=>o,t.value.halfwidthDotSingleQuotationSpace?o=>o.replace(/(\.\') ([^\n])/g,`$1
$2`):o=>o,t.value.fullwidthDot?o=>o.replace(/(\uff0e)([^\n])/g,`$1
$2`):o=>o,t.value.fullwidthSmallCircle?o=>o.replace(/(。)([^\n])/g,`$1
$2`):o=>o];n.value=n.value.split(`
`).map(o=>f.detect(o).isParagraphingComposition()?a.reduce((i,d)=>d(i),o):o).join(`
`)},oneParagraphPerLine:()=>{var a="",o="";n.value.split(`
`).forEach(d=>{f.detect(d).isParagraphingComposition()?o+=`${d}
`:(a+=i(o),o="",a+=`${d}
`)}),n.value=(a+i(o)).trimEnd();function i(d){return[p=>p.replace(/([ -~]) ?\n([^\n])/g,"$1 $2"),p=>p.replace(/([^ -~\n]) ?\n([^\n])/g,"$1$2")].reduce((p,b)=>b(p),d)}}}}class Yn{entry(t,e){const{type:s,text:a}=e;e.isLineBreak()||t.push(new W(s,a))}do(t,e){const{type:s,text:a}=e;e.isSingleLineComposition()&&t.push(new W(s,a)),e.isParagraphingComposition()&&t[t.length-1].append(a)}}class to{constructor(){I(this,"status");I(this,"elements");I(this,"action");this.status=z.BEGIN,this.elements=[],this.action=new Yn}compose(t){const e=f.detect(t),s=this.nextStatus(e);this.doAction(s,e),this.status=s}nextStatus(t){return t.isLineBreak()?z.BEGIN:t.isSingleLineComposition()?z.SINGLE_LINE_COMPOSITION:z.PARAGRAPHING_COMPOSITION}doAction(t,e){this.status!=t?this.action.entry(this.elements,e):this.action.do(this.elements,e)}}var z=(n=>(n.BEGIN="BEGIN",n.SINGLE_LINE_COMPOSITION="SINGLE_LINE_COMPOSITION",n.PARAGRAPHING_COMPOSITION="PARAGRAPHING_COMPOSITION",n))(z||{});function eo(n,t){return{structure:S(()=>{const s=new to,a=[t.value.halfwidthDotSpace?o=>o.replace(/(\. )/g,`$1
`):o=>o,t.value.halfwidthDotDoubleQuotationSpace?o=>o.replace(/(\.\" )/g,`$1
`):o=>o,t.value.halfwidthDotSingleQuotationSpace?o=>o.replace(/(\.\' )/g,`$1
`):o=>o,t.value.fullwidthDot?o=>o.replace(/(\uff0e)/g,`$1
`):o=>o,t.value.fullwidthSmallCircle?o=>o.replace(/(。)/g,`$1
`):o=>o];return n.value.trim().replace(/\n\n+/g,`

`).split(`
`).map(o=>f.detect(o).isParagraphingComposition()?a.reduce((i,d)=>d(i),o):o).flatMap(o=>o.trim().split(`
`)).map(o=>o.trim()).forEach(o=>s.compose(o)),s.elements})}}const io=V({__name:"index",setup(n){const{text:t,textEmpty:e,clearText:s}=Wn(),{loadFromClipboard:a,saveToClipboard:o}=Qn(t),{loadFromLocalStorage:i,saveToLocalStorage:d}=qn(t),{canUndo:C,canRedo:p,undo:b,redo:D}=Xn(t),{settings:N}=Ht(),{oneSentencePerLine:A,oneParagraphPerLine:w}=Jn(t,N),{structure:O}=eo(t,N),B=y(!1),k=()=>{B.value=!0},P=y(""),st=async()=>{e.value||(await o(),j.show({pos:"bottom-center",text:"text was copied to clipboard",actionText:"OK"}))},it=()=>{e.value||(d(),j.show({pos:"bottom-center",text:"text was saved to local storage",actionText:"OK"}))},lt=()=>{e.value||A()},ct=()=>{e.value||w()};return(no,M)=>{const rt=Lt,dt=Ge,ut=dn,_t=$n,ht=Vn,pt=En,ft=jn;return l(),Y(ft,null,{"left-page":v(()=>[h(dt,{"text-empty":u(e),"can-undo":u(C),"can-redo":u(p),onNewClick:u(s),onClipboardClick:u(a),onCopyClick:st,onFolderClick:k,onSaveClick:it,onUndoClick:u(b),onRedoClick:u(D),onFormatOsplClick:lt,onFormatOpplClick:ct},{default:v(()=>[h(rt,{modelValue:u(t),"onUpdate:modelValue":M[0]||(M[0]=R=>tt(t)?t.value=R:null)},null,8,["modelValue"])]),_:1},8,["text-empty","can-undo","can-redo","onNewClick","onClipboardClick","onUndoClick","onRedoClick"]),h(ut,{dialog:B.value,"onUpdate:dialog":M[1]||(M[1]=R=>B.value=R),onLoad:u(i)},null,8,["dialog","onLoad"])]),"right-page":v(()=>[h(pt,{menu:P.value,"onUpdate:menu":M[2]||(M[2]=R=>P.value=R)},{default:v(()=>[h(ht,{structure:u(O)},{default:v(()=>[h(_t,{structure:u(O),style:kt(P.value)},null,8,["structure","style"])]),_:1},8,["structure"])]),_:1},8,["menu"])]),_:1})}}});export{io as default};
